"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[310],{1851:function(e,t,n){n.d(t,{$i:function(){return er},AL:function(){return ev},B1:function(){return e0},Eg:function(){return C},FD:function(){return tn},Hm:function(){return ek},IY:function(){return c},J$:function(){return G},J3:function(){return B},JU:function(){return eZ},Ki:function(){return et},Ky:function(){return N},Ly:function(){return y},N5:function(){return ew},OH:function(){return eD},OL:function(){return eh},OQ:function(){return ez},OW:function(){return eV},PS:function(){return Q},Q5:function(){return eu},QZ:function(){return v},Qj:function(){return E},Ql:function(){return tt},RX:function(){return S},RY:function(){return eA},Rf:function(){return ed},S2:function(){return eg},VV:function(){return ej},Vt:function(){return L},W0:function(){return _},WD:function(){return O},X6:function(){return ts},Z:function(){return z},ZB:function(){return ec},Z_:function(){return eT},Zp:function(){return A},_2:function(){return en},be:function(){return e3},dW:function(){return eF},f5:function(){return R},hO:function(){return e1},jD:function(){return s},k5:function(){return I},kE:function(){return ee},lM:function(){return eE},lp:function(){return $},m:function(){return eo},n3:function(){return eX},nb:function(){return es},nu:function(){return ef},oC:function(){return e8},oI:function(){return J},oW:function(){return h},oj:function(){return ei},pB:function(){return p},q7:function(){return Z},s$:function(){return em},so:function(){return eG},t8:function(){return f},t_:function(){return ep},wQ:function(){return P},wv:function(){return eM},xx:function(){return eH},yF:function(){return eU}});var o,i,l,r,u,a,d,s,c,h,f,v,y,p,g=n(5534),x=n(5702),m=n(6881),w=n(517),M=n(1668),b=n(8324);let E={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>'Node type "'.concat(e,'" not found. Using fallback type "default".'),error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>"The old edge with id=".concat(e," does not exist."),error009:e=>'Marker type "'.concat(e,"\" doesn't exist."),error008:(e,t)=>{let{id:n,sourceHandle:o,targetHandle:i}=t;return"Couldn't create edge for ".concat(e,' handle id: "').concat("source"===e?o:i,'", edge id: ').concat(n,".")},error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>'Edge type "'.concat(e,'" not found. Using fallback type "default".'),error012:e=>'Node with id "'.concat(e,'" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.'),error013:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"react";return"It seems that you haven't loaded the styles. Please import '@xyflow/".concat(e,"/dist/style.css' or base.css to make sure everything is working properly.")},error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},I=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],P=["Enter"," ","Escape"],z={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":e=>{let{direction:t,x:n,y:o}=e;return"Moved selected node ".concat(t,". New position, x: ").concat(n,", y: ").concat(o)},"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};(o=s||(s={})).Strict="strict",o.Loose="loose",(i=c||(c={})).Free="free",i.Vertical="vertical",i.Horizontal="horizontal",(l=h||(h={})).Partial="partial",l.Full="full";let N={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};(r=f||(f={})).Bezier="default",r.Straight="straight",r.Step="step",r.SmoothStep="smoothstep",r.SimpleBezier="simplebezier",(u=v||(v={})).Arrow="arrow",u.ArrowClosed="arrowclosed",(a=y||(y={})).Left="left",a.Top="top",a.Right="right",a.Bottom="bottom";let H={[y.Left]:y.Right,[y.Right]:y.Left,[y.Top]:y.Bottom,[y.Bottom]:y.Top};function A(e){return null===e?null:e?"valid":"invalid"}let B=e=>"id"in e&&"source"in e&&"target"in e,L=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),T=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),k=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{width:o,height:i}=ed(e),l=null!==(t=e.origin)&&void 0!==t?t:n,r=o*l[0],u=i*l[1];return{x:e.position.x-r,y:e.position.y-u}},S=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{nodeOrigin:[0,0]};return 0===e.length?{x:0,y:0,width:0,height:0}:j(e.reduce((e,n)=>{let o="string"==typeof n,i=t.nodeLookup||o?void 0:n;return t.nodeLookup&&(i=o?t.nodeLookup.get(n):T(n)?n:t.nodeLookup.get(n.id)),q(e,i?U(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0})},{x:1/0,y:1/0,x2:-1/0,y2:-1/0}))},_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(e=>{(void 0===t.filter||t.filter(e))&&(n=q(n,U(e)),o=!0)}),o?j(n):{x:0,y:0,width:0,height:0}},R=function(e,t){let[n,o,i]=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u={...eo(t,[n,o,i]),width:t.width/i,height:t.height/i},a=[];for(let t of e.values()){var d,s,c,h,f,v;let{measured:e,selectable:n=!0,hidden:o=!1}=t;if(r&&!n||o)continue;let i=null!==(c=null!==(s=null!==(d=e.width)&&void 0!==d?d:t.width)&&void 0!==s?s:t.initialWidth)&&void 0!==c?c:null,y=null!==(v=null!==(f=null!==(h=e.height)&&void 0!==h?h:t.height)&&void 0!==f?f:t.initialHeight)&&void 0!==v?v:null,p=$(u,Q(t)),g=(null!=i?i:0)*(null!=y?y:0),x=l&&p>0;(!t.internals.handleBounds||x||p>=g||t.dragging)&&a.push(t)}return a},V=(e,t)=>{let n=new Set;return e.forEach(e=>{n.add(e.id)}),t.filter(e=>n.has(e.source)||n.has(e.target))};async function C(e,t){var n,o,i;let{nodes:l,width:r,height:u,panZoom:a,minZoom:d,maxZoom:s}=e;if(0===l.size)return Promise.resolve(!0);let c=er(_(function(e,t){let n=new Map,o=(null==t?void 0:t.nodes)?new Set(t.nodes.map(e=>e.id)):null;return e.forEach(e=>{e.measured.width&&e.measured.height&&((null==t?void 0:t.includeHiddenNodes)||!e.hidden)&&(!o||o.has(e.id))&&n.set(e.id,e)}),n}(l,t)),r,u,null!==(n=null==t?void 0:t.minZoom)&&void 0!==n?n:d,null!==(o=null==t?void 0:t.maxZoom)&&void 0!==o?o:s,null!==(i=null==t?void 0:t.padding)&&void 0!==i?i:.1);return await a.setViewport(c,{duration:null==t?void 0:t.duration,ease:null==t?void 0:t.ease,interpolate:null==t?void 0:t.interpolate}),Promise.resolve(!0)}function Z(e){var t,n,o;let{nodeId:i,nextPosition:l,nodeLookup:r,nodeOrigin:u=[0,0],nodeExtent:a,onError:d}=e,s=r.get(i),c=s.parentId?r.get(s.parentId):void 0,{x:h,y:f}=c?c.internals.positionAbsolute:{x:0,y:0},v=null!==(t=s.origin)&&void 0!==t?t:u,y=s.extent||a;if("parent"!==s.extent||s.expandParent)c&&ea(s.extent)&&(y=[[s.extent[0][0]+h,s.extent[0][1]+f],[s.extent[1][0]+h,s.extent[1][1]+f]]);else if(c){let e=c.measured.width,t=c.measured.height;e&&t&&(y=[[h,f],[h+e,f+t]])}else null==d||d("005",E.error005());let p=ea(y)?Y(l,y,s.measured):l;return(void 0===s.measured.width||void 0===s.measured.height)&&(null==d||d("015",E.error015())),{position:{x:p.x-h+(null!==(n=s.measured.width)&&void 0!==n?n:0)*v[0],y:p.y-f+(null!==(o=s.measured.height)&&void 0!==o?o:0)*v[1]},positionAbsolute:p}}async function O(e){let{nodesToRemove:t=[],edgesToRemove:n=[],nodes:o,edges:i,onBeforeDelete:l}=e,r=new Set(t.map(e=>e.id)),u=[];for(let e of o){if(!1===e.deletable)continue;let t=r.has(e.id),n=!t&&e.parentId&&u.find(t=>t.id===e.parentId);(t||n)&&u.push(e)}let a=new Set(n.map(e=>e.id)),d=i.filter(e=>!1!==e.deletable),s=V(u,d);for(let e of d)a.has(e.id)&&!s.find(t=>t.id===e.id)&&s.push(e);if(!l)return{edges:s,nodes:u};let c=await l({nodes:u,edges:s});return"boolean"==typeof c?c?{edges:s,nodes:u}:{edges:[],nodes:[]}:c}let D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)},Y=function(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return{x:D(n.x,o[0][0],o[1][0]-(null!==(e=null==i?void 0:i.width)&&void 0!==e?e:0)),y:D(n.y,o[0][1],o[1][1]-(null!==(t=null==i?void 0:i.height)&&void 0!==t?t:0))}};function F(e,t,n){let{width:o,height:i}=ed(n),{x:l,y:r}=n.internals.positionAbsolute;return Y(e,[[l,r],[l+o,r+i]],t)}let X=(e,t,n)=>e<t?D(Math.abs(e-t),1,t)/t:e>n?-D(Math.abs(e-n),1,t)/t:0,W=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40;return[X(e.x,o,t.width-o)*n,X(e.y,o,t.height-o)*n]},q=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),K=e=>{let{x:t,y:n,width:o,height:i}=e;return{x:t,y:n,x2:t+o,y2:n+i}},j=e=>{let{x:t,y:n,x2:o,y2:i}=e;return{x:t,y:n,width:o-t,height:i-n}},Q=function(e){var t,n,o,i,l,r,u,a;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{x:s,y:c}=T(e)?e.internals.positionAbsolute:k(e,d);return{x:s,y:c,width:null!==(l=null!==(i=null!==(o=null===(t=e.measured)||void 0===t?void 0:t.width)&&void 0!==o?o:e.width)&&void 0!==i?i:e.initialWidth)&&void 0!==l?l:0,height:null!==(a=null!==(u=null!==(r=null===(n=e.measured)||void 0===n?void 0:n.height)&&void 0!==r?r:e.height)&&void 0!==u?u:e.initialHeight)&&void 0!==a?a:0}},U=function(e){var t,n,o,i,l,r,u,a;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{x:s,y:c}=T(e)?e.internals.positionAbsolute:k(e,d);return{x:s,y:c,x2:s+(null!==(l=null!==(i=null!==(o=null===(t=e.measured)||void 0===t?void 0:t.width)&&void 0!==o?o:e.width)&&void 0!==i?i:e.initialWidth)&&void 0!==l?l:0),y2:c+(null!==(a=null!==(u=null!==(r=null===(n=e.measured)||void 0===n?void 0:n.height)&&void 0!==r?r:e.height)&&void 0!==u?u:e.initialHeight)&&void 0!==a?a:0)}},J=(e,t)=>j(q(K(e),K(t))),$=(e,t)=>Math.ceil(Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x))*Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y))),G=e=>ee(e.width)&&ee(e.height)&&ee(e.x)&&ee(e.y),ee=e=>!isNaN(e)&&isFinite(e),et=(e,t)=>{},en=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1];return{x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}},eo=function(e,t){let{x:n,y:o}=e,[i,l,r]=t,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],d={x:(n-i)/r,y:(o-l)/r};return u?en(d,a):d},ei=(e,t)=>{let{x:n,y:o}=e,[i,l,r]=t;return{x:n*r+i,y:o*r+l}};function el(e,t){if("number"==typeof e)return Math.floor((t-t/(1+e))*.5);if("string"==typeof e&&e.endsWith("px")){let t=parseFloat(e);if(!Number.isNaN(t))return Math.floor(t)}if("string"==typeof e&&e.endsWith("%")){let n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error('[React Flow] The padding value "'.concat(e,'" is invalid. Please provide a number or a string with a valid unit (px or %).')),0}let er=(e,t,n,o,i,l)=>{let r=function(e,t,n){if("string"==typeof e||"number"==typeof e){let o=el(e,n),i=el(e,t);return{top:o,right:i,bottom:o,left:i,x:2*i,y:2*o}}if("object"==typeof e){var o,i,l,r,u,a,d,s;let c=el(null!==(i=null!==(o=e.top)&&void 0!==o?o:e.y)&&void 0!==i?i:0,n),h=el(null!==(r=null!==(l=e.bottom)&&void 0!==l?l:e.y)&&void 0!==r?r:0,n),f=el(null!==(a=null!==(u=e.left)&&void 0!==u?u:e.x)&&void 0!==a?a:0,t),v=el(null!==(s=null!==(d=e.right)&&void 0!==d?d:e.x)&&void 0!==s?s:0,t);return{top:c,right:v,bottom:h,left:f,x:f+v,y:c+h}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}(l,t,n),u=D(Math.min((t-r.x)/e.width,(n-r.y)/e.height),o,i),a=e.x+e.width/2,d=e.y+e.height/2,s=t/2-a*u,c=n/2-d*u,h=function(e,t,n,o,i,l){let{x:r,y:u}=ei(e,[t,n,o]),{x:a,y:d}=ei({x:e.x+e.width,y:e.y+e.height},[t,n,o]);return{left:Math.floor(r),top:Math.floor(u),right:Math.floor(i-a),bottom:Math.floor(l-d)}}(e,s,c,u,t,n),f={left:Math.min(h.left-r.left,0),top:Math.min(h.top-r.top,0),right:Math.min(h.right-r.right,0),bottom:Math.min(h.bottom-r.bottom,0)};return{x:s-f.left+f.right,y:c-f.top+f.bottom,zoom:u}},eu=()=>{var e,t;return"undefined"!=typeof navigator&&(null===(t=navigator)||void 0===t?void 0:null===(e=t.userAgent)||void 0===e?void 0:e.indexOf("Mac"))>=0};function ea(e){return null!=e&&"parent"!==e}function ed(e){var t,n,o,i,l,r,u,a;return{width:null!==(l=null!==(i=null!==(o=null===(t=e.measured)||void 0===t?void 0:t.width)&&void 0!==o?o:e.width)&&void 0!==i?i:e.initialWidth)&&void 0!==l?l:0,height:null!==(a=null!==(u=null!==(r=null===(n=e.measured)||void 0===n?void 0:n.height)&&void 0!==r?r:e.height)&&void 0!==u?u:e.initialHeight)&&void 0!==a?a:0}}function es(e){var t,n,o,i,l,r;return(null!==(i=null!==(o=null===(t=e.measured)||void 0===t?void 0:t.width)&&void 0!==o?o:e.width)&&void 0!==i?i:e.initialWidth)!==void 0&&(null!==(r=null!==(l=null===(n=e.measured)||void 0===n?void 0:n.height)&&void 0!==l?l:e.height)&&void 0!==r?r:e.initialHeight)!==void 0}function ec(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:0,height:0},n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l={...e},r=o.get(n);if(r){var u,a;let e=r.origin||i;l.x+=r.internals.positionAbsolute.x-(null!==(u=t.width)&&void 0!==u?u:0)*e[0],l.y+=r.internals.positionAbsolute.y-(null!==(a=t.height)&&void 0!==a?a:0)*e[1]}return l}function eh(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function ef(){let e,t;return{promise:new Promise((n,o)=>{e=n,t=o}),resolve:e,reject:t}}function ev(e){return{...z,...e||{}}}function ey(e,t){var n,o;let{snapGrid:i=[0,0],snapToGrid:l=!1,transform:r,containerBounds:u}=t,{x:a,y:d}=eM(e),s=eo({x:a-(null!==(n=null==u?void 0:u.left)&&void 0!==n?n:0),y:d-(null!==(o=null==u?void 0:u.top)&&void 0!==o?o:0)},r),{x:c,y:h}=l?en(s,i):s;return{xSnapped:c,ySnapped:h,...s}}let ep=e=>({width:e.offsetWidth,height:e.offsetHeight}),eg=e=>{var t,n;return(null==e?void 0:null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||(null===(n=window)||void 0===n?void 0:n.document)},ex=["INPUT","SELECT","TEXTAREA"];function em(e){var t,n;let o=(null===(n=e.composedPath)||void 0===n?void 0:null===(t=n.call(e))||void 0===t?void 0:t[0])||e.target;return(null==o?void 0:o.nodeType)===1&&(ex.includes(o.nodeName)||o.hasAttribute("contenteditable")||!!o.closest(".nokey"))}let ew=e=>"clientX"in e,eM=(e,t)=>{var n,o,i,l;let r=ew(e),u=r?e.clientX:null===(n=e.touches)||void 0===n?void 0:n[0].clientX,a=r?e.clientY:null===(o=e.touches)||void 0===o?void 0:o[0].clientY;return{x:u-(null!==(i=null==t?void 0:t.left)&&void 0!==i?i:0),y:a-(null!==(l=null==t?void 0:t.top)&&void 0!==l?l:0)}},eb=(e,t,n,o,i)=>{let l=t.querySelectorAll(".".concat(e));return l&&l.length?Array.from(l).map(t=>{let l=t.getBoundingClientRect();return{id:t.getAttribute("data-handleid"),type:e,nodeId:i,position:t.getAttribute("data-handlepos"),x:(l.left-n.left)/o,y:(l.top-n.top)/o,...ep(t)}}):null};function eE(e){let{sourceX:t,sourceY:n,targetX:o,targetY:i,sourceControlX:l,sourceControlY:r,targetControlX:u,targetControlY:a}=e,d=.125*t+.375*l+.375*u+.125*o,s=.125*n+.375*r+.375*a+.125*i;return[d,s,Math.abs(d-t),Math.abs(s-n)]}function eI(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function eP(e){let{pos:t,x1:n,y1:o,x2:i,y2:l,c:r}=e;switch(t){case y.Left:return[n-eI(n-i,r),o];case y.Right:return[n+eI(i-n,r),o];case y.Top:return[n,o-eI(o-l,r)];case y.Bottom:return[n,o+eI(l-o,r)]}}function ez(e){let{sourceX:t,sourceY:n,sourcePosition:o=y.Bottom,targetX:i,targetY:l,targetPosition:r=y.Top,curvature:u=.25}=e,[a,d]=eP({pos:o,x1:t,y1:n,x2:i,y2:l,c:u}),[s,c]=eP({pos:r,x1:i,y1:l,x2:t,y2:n,c:u}),[h,f,v,p]=eE({sourceX:t,sourceY:n,targetX:i,targetY:l,sourceControlX:a,sourceControlY:d,targetControlX:s,targetControlY:c});return["M".concat(t,",").concat(n," C").concat(a,",").concat(d," ").concat(s,",").concat(c," ").concat(i,",").concat(l),h,f,v,p]}function eN(e){let{sourceX:t,sourceY:n,targetX:o,targetY:i}=e,l=Math.abs(o-t)/2,r=Math.abs(i-n)/2;return[o<t?o+l:o-l,i<n?i+r:i-r,l,r]}function eH(e){let{sourceNode:t,targetNode:n,selected:o=!1,zIndex:i=0,elevateOnSelect:l=!1,zIndexMode:r="basic"}=e;if("manual"===r)return i;let u=Math.max(t.parentId||l&&t.selected?t.internals.z:0,n.parentId||l&&n.selected?n.internals.z:0);return(l&&o?i+1e3:i)+u}function eA(e){let{sourceNode:t,targetNode:n,width:o,height:i,transform:l}=e,r=q(U(t),U(n));return r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1),$({x:-l[0]/l[2],y:-l[1]/l[2],width:o/l[2],height:i/l[2]},j(r))>0}let eB=e=>{let{source:t,sourceHandle:n,target:o,targetHandle:i}=e;return"xy-edge__".concat(t).concat(n||"","-").concat(o).concat(i||"")},eL=(e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)),eT=function(e,t){let n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.source||!e.target)return et("006",E.error006()),t;let i=o.getEdgeId||eB;return eL(n=B(e)?{...e}:{...e,id:i(e)},t)?t:(null===n.sourceHandle&&delete n.sourceHandle,null===n.targetHandle&&delete n.targetHandle,t.concat(n))};function ek(e){let{sourceX:t,sourceY:n,targetX:o,targetY:i}=e,[l,r,u,a]=eN({sourceX:t,sourceY:n,targetX:o,targetY:i});return["M ".concat(t,",").concat(n,"L ").concat(o,",").concat(i),l,r,u,a]}let eS={[y.Left]:{x:-1,y:0},[y.Right]:{x:1,y:0},[y.Top]:{x:0,y:-1},[y.Bottom]:{x:0,y:1}},e_=e=>{let{source:t,sourcePosition:n=y.Bottom,target:o}=e;return n===y.Left||n===y.Right?t.x<o.x?{x:1,y:0}:{x:-1,y:0}:t.y<o.y?{x:0,y:1}:{x:0,y:-1}},eR=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function eV(e){let{sourceX:t,sourceY:n,sourcePosition:o=y.Bottom,targetX:i,targetY:l,targetPosition:r=y.Top,borderRadius:u=5,centerX:a,centerY:d,offset:s=20,stepPosition:c=.5}=e,[h,f,v,p,g]=function(e){let t,n,{source:o,sourcePosition:i=y.Bottom,target:l,targetPosition:r=y.Top,center:u,offset:a,stepPosition:d}=e,s=eS[i],c=eS[r],h={x:o.x+s.x*a,y:o.y+s.y*a},f={x:l.x+c.x*a,y:l.y+c.y*a},v=e_({source:h,sourcePosition:i,target:f}),p=0!==v.x?"x":"y",g=v[p],x=[],m={x:0,y:0},w={x:0,y:0},[,,M,b]=eN({sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y});if(s[p]*c[p]==-1){var E,I,P,z;"x"===p?(t=null!==(E=u.x)&&void 0!==E?E:h.x+(f.x-h.x)*d,n=null!==(I=u.y)&&void 0!==I?I:(h.y+f.y)/2):(t=null!==(P=u.x)&&void 0!==P?P:(h.x+f.x)/2,n=null!==(z=u.y)&&void 0!==z?z:h.y+(f.y-h.y)*d);let e=[{x:t,y:h.y},{x:t,y:f.y}],o=[{x:h.x,y:n},{x:f.x,y:n}];x=s[p]===g?"x"===p?e:o:"x"===p?o:e}else{let e=[{x:h.x,y:f.y}],u=[{x:f.x,y:h.y}];if(x="x"===p?s.x===g?u:e:s.y===g?e:u,i===r){let e=Math.abs(o[p]-l[p]);if(e<=a){let t=Math.min(a-1,a-e);s[p]===g?m[p]=(h[p]>o[p]?-1:1)*t:w[p]=(f[p]>l[p]?-1:1)*t}}if(i!==r){let t="x"===p?"y":"x",n=s[p]===c[t],o=h[t]>f[t],i=h[t]<f[t];(1===s[p]&&(!n&&o||n&&i)||1!==s[p]&&(!n&&i||n&&o))&&(x="x"===p?e:u)}let d={x:h.x+m.x,y:h.y+m.y},v={x:f.x+w.x,y:f.y+w.y};Math.max(Math.abs(d.x-x[0].x),Math.abs(v.x-x[0].x))>=Math.max(Math.abs(d.y-x[0].y),Math.abs(v.y-x[0].y))?(t=(d.x+v.x)/2,n=x[0].y):(t=x[0].x,n=(d.y+v.y)/2)}return[[o,{x:h.x+m.x,y:h.y+m.y},...x,{x:f.x+w.x,y:f.y+w.y},l],t,n,M,b]}({source:{x:t,y:n},sourcePosition:o,target:{x:i,y:l},targetPosition:r,center:{x:a,y:d},offset:s,stepPosition:c});return[h.reduce((e,t,n)=>e+(n>0&&n<h.length-1?function(e,t,n,o){let i=Math.min(eR(e,t)/2,eR(t,n)/2,o),{x:l,y:r}=t;if(e.x===l&&l===n.x||e.y===r&&r===n.y)return"L".concat(l," ").concat(r);if(e.y===r){let t=e.x<n.x?-1:1,o=e.y<n.y?1:-1;return"L ".concat(l+i*t,",").concat(r,"Q ").concat(l,",").concat(r," ").concat(l,",").concat(r+i*o)}let u=e.x<n.x?1:-1,a=e.y<n.y?-1:1;return"L ".concat(l,",").concat(r+i*a,"Q ").concat(l,",").concat(r," ").concat(l+i*u,",").concat(r)}(h[n-1],t,h[n+1],u):"".concat(0===n?"M":"L").concat(t.x," ").concat(t.y)),""),f,v,p,g]}function eC(e){var t;return e&&!!(e.internals.handleBounds||(null===(t=e.handles)||void 0===t?void 0:t.length))&&!!(e.measured.width||e.width||e.initialWidth)}function eZ(e){var t,n,o,i,l;let{sourceNode:r,targetNode:u}=e;if(!eC(r)||!eC(u))return null;let a=r.internals.handleBounds||eO(r.handles),d=u.internals.handleBounds||eO(u.handles),c=eY(null!==(t=null==a?void 0:a.source)&&void 0!==t?t:[],e.sourceHandle),h=eY(e.connectionMode===s.Strict?null!==(n=null==d?void 0:d.target)&&void 0!==n?n:[]:(null!==(o=null==d?void 0:d.target)&&void 0!==o?o:[]).concat(null!==(i=null==d?void 0:d.source)&&void 0!==i?i:[]),e.targetHandle);if(!c||!h)return null===(l=e.onError)||void 0===l||l.call(e,"008",E.error008(c?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;let f=(null==c?void 0:c.position)||y.Bottom,v=(null==h?void 0:h.position)||y.Top,p=eD(r,c,f),g=eD(u,h,v);return{sourceX:p.x,sourceY:p.y,targetX:g.x,targetY:g.y,sourcePosition:f,targetPosition:v}}function eO(e){if(!e)return null;let t=[],n=[];for(let l of e){var o,i;l.width=null!==(o=l.width)&&void 0!==o?o:1,l.height=null!==(i=l.height)&&void 0!==i?i:1,"source"===l.type?t.push(l):"target"===l.type&&n.push(l)}return{source:t,target:n}}function eD(e,t){var n,o,i;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.Left,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=(null!==(n=null==t?void 0:t.x)&&void 0!==n?n:0)+e.internals.positionAbsolute.x,a=(null!==(o=null==t?void 0:t.y)&&void 0!==o?o:0)+e.internals.positionAbsolute.y,{width:d,height:s}=null!=t?t:ed(e);if(r)return{x:u+d/2,y:a+s/2};switch(null!==(i=null==t?void 0:t.position)&&void 0!==i?i:l){case y.Top:return{x:u+d/2,y:a};case y.Right:return{x:u+d,y:a+s/2};case y.Bottom:return{x:u+d/2,y:a+s};case y.Left:return{x:u,y:a+s/2}}}function eY(e,t){return e&&(t?e.find(e=>e.id===t):e[0])||null}function eF(e,t){return e?"string"==typeof e?e:"".concat(t?"".concat(t,"__"):"").concat(Object.keys(e).sort().map(t=>"".concat(t,"=").concat(e[t])).join("&")):""}function eX(e,t){let{id:n,defaultColor:o,defaultMarkerStart:i,defaultMarkerEnd:l}=t,r=new Set;return e.reduce((e,t)=>([t.markerStart||i,t.markerEnd||l].forEach(t=>{if(t&&"object"==typeof t){let i=eF(t,n);r.has(i)||(e.push({id:i,color:t.color||o,...t}),r.add(i))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}let eW={nodeOrigin:[0,0],nodeExtent:I,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},eq={...eW,checkEquality:!0};function eK(e,t){let n={...e};for(let e in t)void 0!==t[e]&&(n[e]=t[e]);return n}function ej(e,t,n){let o=eK(eW,n);for(let n of e.values())if(n.parentId)eJ(n,e,t,o);else{let e=Y(k(n,o.nodeOrigin),ea(n.extent)?n.extent:o.nodeExtent,ed(n));n.internals.positionAbsolute=e}}function eQ(e){return"manual"===e}function eU(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=eK(eq,o),l={i:0},r=new Map(t),u=(null==i?void 0:i.elevateNodesOnSelect)&&!eQ(i.zIndexMode)?1e3:0,a=e.length>0;for(let c of(t.clear(),n.clear(),e)){let e=r.get(c.id);if(i.checkEquality&&c===(null==e?void 0:e.internals.userNode))t.set(c.id,e);else{var d,s;let n=Y(k(c,i.nodeOrigin),ea(c.extent)?c.extent:i.nodeExtent,ed(c));e={...i.defaults,...c,measured:{width:null===(d=c.measured)||void 0===d?void 0:d.width,height:null===(s=c.measured)||void 0===s?void 0:s.height},internals:{positionAbsolute:n,handleBounds:function(e,t){if(!e.handles)return e.measured?null==t?void 0:t.internals.handleBounds:void 0;let n=[],o=[];for(let t of e.handles){var i,l;let r={id:t.id,width:null!==(i=t.width)&&void 0!==i?i:1,height:null!==(l=t.height)&&void 0!==l?l:1,nodeId:e.id,x:t.x,y:t.y,position:t.position,type:t.type};"source"===t.type?n.push(r):"target"===t.type&&o.push(r)}return{source:n,target:o}}(c,e),z:e$(c,u,i.zIndexMode),userNode:c}},t.set(c.id,e)}void 0!==e.measured&&void 0!==e.measured.width&&void 0!==e.measured.height||e.hidden||(a=!1),c.parentId&&eJ(e,t,n,o,l)}return a}function eJ(e,t,n,o,i){let{elevateNodesOnSelect:l,nodeOrigin:r,nodeExtent:u,zIndexMode:a}=eK(eW,o),d=e.parentId,s=t.get(d);if(!s){console.warn("Parent node ".concat(d," not found. Please make sure that parent nodes are in front of their child nodes in the nodes array."));return}!function(e,t){if(!e.parentId)return;let n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}(e,n),i&&!s.parentId&&void 0===s.internals.rootParentIndex&&"auto"===a&&(s.internals.rootParentIndex=++i.i,s.internals.z=s.internals.z+10*i.i),i&&void 0!==s.internals.rootParentIndex&&(i.i=s.internals.rootParentIndex);let{x:c,y:h,z:f}=function(e,t,n,o,i,l){var r;let{x:u,y:a}=t.internals.positionAbsolute,d=ed(e),s=k(e,n),c=ea(e.extent)?Y(s,e.extent,d):s,h=Y({x:u+c.x,y:a+c.y},o,d);"parent"===e.extent&&(h=F(h,d,t));let f=e$(e,i,l),v=null!==(r=t.internals.z)&&void 0!==r?r:0;return{x:h.x,y:h.y,z:v>=f?v+1:f}}(e,s,r,u,l&&!eQ(a)?1e3:0,a),{positionAbsolute:v}=e.internals,y=c!==v.x||h!==v.y;(y||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:c,y:h}:v,z:f}})}function e$(e,t,n){let o=ee(e.zIndex)?e.zIndex:0;return eQ(n)?o:o+(e.selected?t:0)}function eG(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0],i=[],l=new Map;for(let n of e){var r,u;let e=t.get(n.parentId);if(!e)continue;let o=J(null!==(u=null===(r=l.get(n.parentId))||void 0===r?void 0:r.expandedRect)&&void 0!==u?u:Q(e),n.rect);l.set(n.parentId,{expandedRect:o,parent:e})}return l.size>0&&l.forEach((t,l)=>{var r,u;let{expandedRect:a,parent:d}=t,s=d.internals.positionAbsolute,c=ed(d),h=null!==(r=d.origin)&&void 0!==r?r:o,f=a.x<s.x?Math.round(Math.abs(s.x-a.x)):0,v=a.y<s.y?Math.round(Math.abs(s.y-a.y)):0,y=Math.max(c.width,Math.round(a.width)),p=Math.max(c.height,Math.round(a.height)),g=(y-c.width)*h[0],x=(p-c.height)*h[1];(f>0||v>0||g||x)&&(i.push({id:l,type:"position",position:{x:d.position.x-f+g,y:d.position.y-v+x}}),null===(u=n.get(l))||void 0===u||u.forEach(t=>{e.some(e=>e.id===t.id)||i.push({id:t.id,type:"position",position:{x:t.position.x+f,y:t.position.y+v}})})),(c.width<a.width||c.height<a.height||f||v)&&i.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:y+(f?h[0]*f-g:0),height:p+(v?h[1]*v-x:0)}})}),i}function e0(e,t,n,o,i,l,r){let u=null==o?void 0:o.querySelector(".xyflow__viewport"),a=!1;if(!u)return{changes:[],updatedInternals:a};let d=[],s=window.getComputedStyle(u),{m22:c}=new window.DOMMatrixReadOnly(s.transform),h=[];for(let o of e.values()){let e=t.get(o.id);if(!e)continue;if(e.hidden){t.set(e.id,{...e,internals:{...e.internals,handleBounds:void 0}}),a=!0;continue}let u=ep(o.nodeElement),s=e.measured.width!==u.width||e.measured.height!==u.height;if(u.width&&u.height&&(s||!e.internals.handleBounds||o.force)){let f=o.nodeElement.getBoundingClientRect(),v=ea(e.extent)?e.extent:l,{positionAbsolute:y}=e.internals;e.parentId&&"parent"===e.extent?y=F(y,u,t.get(e.parentId)):v&&(y=Y(y,v,u));let p={...e,measured:u,internals:{...e.internals,positionAbsolute:y,handleBounds:{source:eb("source",o.nodeElement,f,c,e.id),target:eb("target",o.nodeElement,f,c,e.id)}}};t.set(e.id,p),e.parentId&&eJ(p,t,n,{nodeOrigin:i,zIndexMode:r}),a=!0,s&&(d.push({id:e.id,type:"dimensions",dimensions:u}),e.expandParent&&e.parentId&&h.push({id:e.id,parentId:e.parentId,rect:Q(p,i)}))}}if(h.length>0){let e=eG(h,t,n,i);d.push(...e)}return{changes:d,updatedInternals:a}}async function e1(e){let{delta:t,panZoom:n,transform:o,translateExtent:i,width:l,height:r}=e;if(!n||!t.x&&!t.y)return Promise.resolve(!1);let u=await n.setViewportConstrained({x:o[0]+t.x,y:o[1]+t.y,zoom:o[2]},[[0,0],[l,r]],i);return Promise.resolve(!!u&&(u.x!==o[0]||u.y!==o[1]||u.k!==o[2]))}function e2(e,t,n,o,i,l){let r=i,u=o.get(r)||new Map;o.set(r,u.set(n,t)),r="".concat(i,"-").concat(e);let a=o.get(r)||new Map;if(o.set(r,a.set(n,t)),l){r="".concat(i,"-").concat(e,"-").concat(l);let u=o.get(r)||new Map;o.set(r,u.set(n,t))}}function e3(e,t,n){for(let o of(e.clear(),t.clear(),n)){let{source:n,target:i,sourceHandle:l=null,targetHandle:r=null}=o,u={edgeId:o.id,source:n,target:i,sourceHandle:l,targetHandle:r},a="".concat(n,"-").concat(l,"--").concat(i,"-").concat(r);e2("source",u,"".concat(i,"-").concat(r,"--").concat(n,"-").concat(l),e,n,l),e2("target",u,a,e,i,r),t.set(o.id,o)}}function e5(e,t,n){let o=e;do{var i;if(null==o?void 0:null===(i=o.matches)||void 0===i?void 0:i.call(o,t))return!0;if(o===n)break;o=null==o?void 0:o.parentElement}while(o);return!1}function e4(e){var t,n,o;let{nodeId:i,dragItems:l,nodeLookup:r,dragging:u=!0}=e,a=[];for(let[e,t]of l){let n=null===(o=r.get(e))||void 0===o?void 0:o.internals.userNode;n&&a.push({...n,position:t.position,dragging:u})}if(!i)return[a[0],a];let d=null===(t=r.get(i))||void 0===t?void 0:t.internals.userNode;return[d?{...d,position:(null===(n=l.get(i))||void 0===n?void 0:n.position)||d.position,dragging:u}:a[0],a]}function e8(e){let{onNodeMouseDown:t,getStoreItems:n,onDragStart:o,onDrag:i,onDragStop:l}=e,r={x:null,y:null},u=0,a=new Map,d=!1,s={x:0,y:0},c=null,h=!1,f=null,v=!1,y=!1,p=null;return{update:function(e){let{noDragClassName:m,handleSelector:w,domNode:M,isSelectable:b,nodeId:E,nodeClickDistance:I=0}=e;function P(e){let{x:t,y:o}=e,{nodeLookup:l,nodeExtent:u,snapGrid:d,snapToGrid:s,nodeOrigin:c,onNodeDrag:h,onSelectionDrag:f,onError:v,updateNodePositions:g}=n();r={x:t,y:o};let x=!1,m=a.size>1,w=m&&u?K(_(a)):null,M=m&&s?function(e){let{dragItems:t,snapGrid:n,x:o,y:i}=e,l=t.values().next().value;if(!l)return null;let r={x:o-l.distance.x,y:i-l.distance.y},u=en(r,n);return{x:u.x-r.x,y:u.y-r.y}}({dragItems:a,snapGrid:d,x:t,y:o}):null;for(let[e,n]of a){if(!l.has(e))continue;let i={x:t-n.distance.x,y:o-n.distance.y};s&&(i=M?{x:Math.round(i.x+M.x),y:Math.round(i.y+M.y)}:en(i,d));let r=null;if(m&&u&&!n.extent&&w){let{positionAbsolute:e}=n.internals,t=e.x-w.x+u[0][0],o=e.x+n.measured.width-w.x2+u[1][0];r=[[t,e.y-w.y+u[0][1]],[o,e.y+n.measured.height-w.y2+u[1][1]]]}let{position:a,positionAbsolute:h}=Z({nodeId:e,nextPosition:i,nodeLookup:l,nodeExtent:r||u,nodeOrigin:c,onError:v});x=x||n.position.x!==a.x||n.position.y!==a.y,n.position=a,n.internals.positionAbsolute=h}if(y=y||x,x&&(g(a,!0),p&&(i||h||!E&&f))){let[e,t]=e4({nodeId:E,dragItems:a,nodeLookup:l});null==i||i(p,a,e,t),null==h||h(p,e,t),E||null==f||f(p,t)}}async function z(){if(!c)return;let{transform:e,panBy:t,autoPanSpeed:o,autoPanOnNodeDrag:i}=n();if(!i){d=!1,cancelAnimationFrame(u);return}let[l,a]=W(s,c,o);if(0!==l||0!==a){var h,f;r.x=(null!==(h=r.x)&&void 0!==h?h:0)-l/e[2],r.y=(null!==(f=r.y)&&void 0!==f?f:0)-a/e[2],await t({x:l,y:a})&&P(r)}u=requestAnimationFrame(z)}function N(e){let{nodeLookup:i,multiSelectionActive:l,nodesDraggable:u,transform:d,snapGrid:s,snapToGrid:f,selectNodesOnDrag:v,onNodeDragStart:y,onSelectionDragStart:p,unselectNodesAndEdges:g}=n();if(h=!0,(!v||!b)&&!l&&E){var x;(null===(x=i.get(E))||void 0===x?void 0:x.selected)||g()}b&&v&&E&&(null==t||t(E));let m=ey(e.sourceEvent,{transform:d,snapGrid:s,snapToGrid:f,containerBounds:c});if(r=m,(a=function(e,t,n,o){let i=new Map;for(let[u,a]of e)if((a.selected||a.id===o)&&(!a.parentId||!function e(t,n){if(!t.parentId)return!1;let o=n.get(t.parentId);return!!o&&(!!o.selected||e(o,n))}(a,e))&&(a.draggable||t&&void 0===a.draggable)){let t=e.get(u);if(t){var l,r;i.set(u,{id:u,position:t.position||{x:0,y:0},distance:{x:n.x-t.internals.positionAbsolute.x,y:n.y-t.internals.positionAbsolute.y},extent:t.extent,parentId:t.parentId,origin:t.origin,expandParent:t.expandParent,internals:{positionAbsolute:t.internals.positionAbsolute||{x:0,y:0}},measured:{width:null!==(l=t.measured.width)&&void 0!==l?l:0,height:null!==(r=t.measured.height)&&void 0!==r?r:0}})}}return i}(i,u,m,E)).size>0&&(o||y||!E&&p)){let[t,n]=e4({nodeId:E,dragItems:a,nodeLookup:i});null==o||o(e.sourceEvent,a,t,n),null==y||y(e.sourceEvent,t,n),E||null==p||p(e.sourceEvent,n)}}f=(0,x.Z)(M);let H=(0,g.Z)().clickDistance(I).on("start",e=>{let{domNode:t,nodeDragThreshold:o,transform:i,snapGrid:l,snapToGrid:u}=n();c=(null==t?void 0:t.getBoundingClientRect())||null,v=!1,y=!1,p=e.sourceEvent,0===o&&N(e),r=ey(e.sourceEvent,{transform:i,snapGrid:l,snapToGrid:u,containerBounds:c}),s=eM(e.sourceEvent,c)}).on("drag",e=>{let{autoPanOnNodeDrag:t,transform:o,snapGrid:i,snapToGrid:l,nodeDragThreshold:u,nodeLookup:f}=n(),y=ey(e.sourceEvent,{transform:o,snapGrid:i,snapToGrid:l,containerBounds:c});if(p=e.sourceEvent,("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1||E&&!f.has(E))&&(v=!0),!v){if(!d&&t&&h&&(d=!0,z()),!h){let t=eM(e.sourceEvent,c),n=t.x-s.x,o=t.y-s.y;Math.sqrt(n*n+o*o)>u&&N(e)}(r.x!==y.xSnapped||r.y!==y.ySnapped)&&a&&h&&(s=eM(e.sourceEvent,c),P(y))}}).on("end",e=>{if(h&&!v&&(d=!1,h=!1,cancelAnimationFrame(u),a.size>0)){let{nodeLookup:t,updateNodePositions:o,onNodeDragStop:i,onSelectionDragStop:r}=n();if(y&&(o(a,!1),y=!1),l||i||!E&&r){let[n,o]=e4({nodeId:E,dragItems:a,nodeLookup:t,dragging:!1});null==l||l(e.sourceEvent,a,n,o),null==i||i(e.sourceEvent,n,o),E||null==r||r(e.sourceEvent,o)}}}).filter(e=>{let t=e.target;return!e.button&&(!m||!e5(t,".".concat(m),M))&&(!w||e5(t,w,M))});f.call(H)},destroy:function(){null==f||f.on(".drag",null)}}}function e7(e,t,n,o,i){var l,r,u,a,d,s;let c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],h=o.get(e);if(!h)return null;let f="strict"===i?null===(l=h.internals.handleBounds)||void 0===l?void 0:l[t]:[...null!==(a=null===(r=h.internals.handleBounds)||void 0===r?void 0:r.source)&&void 0!==a?a:[],...null!==(d=null===(u=h.internals.handleBounds)||void 0===u?void 0:u.target)&&void 0!==d?d:[]],v=null!==(s=n?null==f?void 0:f.find(e=>e.id===n):null==f?void 0:f[0])&&void 0!==s?s:null;return v&&c?{...v,...eD(h,v,v.position,!0)}:v}function e6(e,t){return e||((null==t?void 0:t.classList.contains("target"))?"target":(null==t?void 0:t.classList.contains("source"))?"source":null)}let e9=()=>!0;function te(e,t){let{handle:n,connectionMode:o,fromNodeId:i,fromHandleId:l,fromType:r,doc:u,lib:a,flowId:d,isValidConnection:c=e9,nodeLookup:h}=t,f="target"===r,v=n?u.querySelector(".".concat(a,'-flow__handle[data-id="').concat(d,"-").concat(null==n?void 0:n.nodeId,"-").concat(null==n?void 0:n.id,"-").concat(null==n?void 0:n.type,'"]')):null,{x:y,y:p}=eM(e),g=u.elementFromPoint(y,p),x=(null==g?void 0:g.classList.contains("".concat(a,"-flow__handle")))?g:v,m={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){let e=e6(void 0,x),t=x.getAttribute("data-nodeid"),n=x.getAttribute("data-handleid"),r=x.classList.contains("connectable"),u=x.classList.contains("connectableend");if(!t||!e)return m;let a={source:f?t:i,sourceHandle:f?n:l,target:f?i:t,targetHandle:f?l:n};m.connection=a;let d=r&&u&&(o===s.Strict?f&&"source"===e||!f&&"target"===e:t!==i||n!==l);m.isValid=d&&c(a),m.toHandle=e7(t,e,n,h,o,!0)}return m}let tt={onPointerDown:function(e,t){let n,{connectionMode:o,connectionRadius:i,handleId:l,nodeId:r,edgeUpdaterType:u,isTarget:a,domNode:d,nodeLookup:s,lib:c,autoPanOnConnect:h,flowId:f,panBy:v,cancelConnection:p,onConnectStart:g,onConnect:x,onConnectEnd:m,isValidConnection:w=e9,onReconnectEnd:M,updateConnection:b,getTransform:E,getFromHandle:I,autoPanSpeed:P,dragThreshold:z=1,handleDomNode:N}=t,A=eg(e.target),B=0,{x:L,y:T}=eM(e),k=e6(u,N),S=null==d?void 0:d.getBoundingClientRect(),_=!1;if(!S||!k)return;let R=e7(r,k,l,s,o);if(!R)return;let V=eM(e,S),C=!1,Z=null,O=!1,D=null,Y={...R,nodeId:r,type:k,position:R.position},F=s.get(r),X={inProgress:!0,isValid:null,from:eD(F,Y,y.Left,!0),fromHandle:Y,fromPosition:Y.position,fromNode:F,to:V,toHandle:null,toPosition:H[Y.position],toNode:null,pointer:V};function q(){_=!0,b(X),null==g||g(e,{nodeId:r,handleId:l,handleType:k})}function K(e){var t,u;let d;if(!_){let{x:t,y:n}=eM(e),o=t-L,i=n-T;if(!(o*o+i*i>z*z))return;q()}if(!I()||!Y){j(e);return}let p=E();n=function(e,t,n,o){var i,l,r,u,a;let d=[],s=1/0;for(let a of function(e,t,n){let o=[],i={x:e.x-n,y:e.y-n,width:2*n,height:2*n};for(let e of t.values())$(i,Q(e))>0&&o.push(e);return o}(e,n,t+250))for(let n of[...null!==(r=null===(i=a.internals.handleBounds)||void 0===i?void 0:i.source)&&void 0!==r?r:[],...null!==(u=null===(l=a.internals.handleBounds)||void 0===l?void 0:l.target)&&void 0!==u?u:[]]){if(o.nodeId===n.nodeId&&o.type===n.type&&o.id===n.id)continue;let{x:i,y:l}=eD(a,n,n.position,!0),r=Math.sqrt(Math.pow(i-e.x,2)+Math.pow(l-e.y,2));r>t||(r<s?(d=[{...n,x:i,y:l}],s=r):r===s&&d.push({...n,x:i,y:l}))}if(!d.length)return null;if(d.length>1){let e="source"===o.type?"target":"source";return null!==(a=d.find(t=>t.type===e))&&void 0!==a?a:d[0]}return d[0]}(eo(V=eM(e,S),p,!1,[1,1]),i,s,Y),C||(function e(){if(!h||!S)return;let[t,n]=W(V,S,P);v({x:t,y:n}),B=requestAnimationFrame(e)}(),C=!0);let g=te(e,{handle:n,connectionMode:o,fromNodeId:r,fromHandleId:l,fromType:a?"target":"source",isValidConnection:w,doc:A,lib:c,flowId:f,nodeLookup:s});D=g.handleDomNode,Z=g.connection,t=!!n,u=g.isValid,d=null,u?d=!0:t&&!u&&(d=!1),O=d;let x=s.get(r),m=x?eD(x,Y,y.Left,!0):X.from,M={...X,from:m,isValid:O,to:g.toHandle&&O?ei({x:g.toHandle.x,y:g.toHandle.y},p):V,toHandle:g.toHandle,toPosition:O&&g.toHandle?g.toHandle.position:H[Y.position],toNode:g.toHandle?s.get(g.toHandle.nodeId):null,pointer:V};b(M),X=M}function j(e){if(!("touches"in e)||!(e.touches.length>0)){if(_){(n||D)&&Z&&O&&(null==x||x(Z));let{inProgress:t,...o}=X,i={...o,toPosition:X.toHandle?X.toPosition:null};null==m||m(e,i),u&&(null==M||M(e,i))}p(),cancelAnimationFrame(B),C=!1,O=!1,Z=null,D=null,A.removeEventListener("mousemove",K),A.removeEventListener("mouseup",j),A.removeEventListener("touchmove",K),A.removeEventListener("touchend",j)}}0===z&&q(),A.addEventListener("mousemove",K),A.addEventListener("mouseup",j),A.addEventListener("touchmove",K),A.addEventListener("touchend",j)},isValid:te};function tn(e){let{domNode:t,panZoom:n,getTransform:o,getViewScale:i}=e,l=(0,x.Z)(t);return{update:function(e){let{translateExtent:t,width:r,height:u,zoomStep:a=1,pannable:d=!0,zoomable:s=!0,inversePan:c=!1}=e,h=[0,0],f=(0,w.sP)().on("start",e=>{if("mousedown"===e.sourceEvent.type||"touchstart"===e.sourceEvent.type){var t,n;h=[null!==(t=e.sourceEvent.clientX)&&void 0!==t?t:e.sourceEvent.touches[0].clientX,null!==(n=e.sourceEvent.clientY)&&void 0!==n?n:e.sourceEvent.touches[0].clientY]}}).on("zoom",d?e=>{var l,a;let d=o();if("mousemove"!==e.sourceEvent.type&&"touchmove"!==e.sourceEvent.type||!n)return;let s=[null!==(l=e.sourceEvent.clientX)&&void 0!==l?l:e.sourceEvent.touches[0].clientX,null!==(a=e.sourceEvent.clientY)&&void 0!==a?a:e.sourceEvent.touches[0].clientY],f=[s[0]-h[0],s[1]-h[1]];h=s;let v=i()*Math.max(d[2],Math.log(d[2]))*(c?-1:1),y={x:d[0]-f[0]*v,y:d[1]-f[1]*v};n.setViewportConstrained({x:y.x,y:y.y,zoom:d[2]},[[0,0],[r,u]],t)}:null).on("zoom.wheel",s?e=>{if("wheel"!==e.sourceEvent.type||!n)return;let t=o(),i=e.sourceEvent.ctrlKey&&eu()?10:1,l=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*a,r=t[2]*Math.pow(2,l*i);n.scaleTo(r)}:null);l.call(f,{})},destroy:function(){l.on("zoom",null)},pointer:m.Z}}let to=e=>({x:e.x,y:e.y,zoom:e.k}),ti=e=>{let{x:t,y:n,zoom:o}=e;return w.CR.translate(t,n).scale(o)},tl=(e,t)=>e.target.closest(".".concat(t)),tr=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),tu=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,ta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tu,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},i="number"==typeof t&&t>0;return i||o(),i?e.transition().duration(t).ease(n).on("end",o):e},td=e=>{let t=e.ctrlKey&&eu()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t};function ts(e){let{domNode:t,minZoom:n,maxZoom:o,translateExtent:i,viewport:l,onPanZoom:r,onPanZoomStart:u,onPanZoomEnd:a,onDraggingChange:d}=e,s={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=t.getBoundingClientRect(),f=(0,w.sP)().scaleExtent([n,o]).translateExtent(i),v=(0,x.Z)(t).call(f);I({x:l.x,y:l.y,zoom:D(l.zoom,n,o)},[[0,0],[h.width,h.height]],i);let y=v.on("wheel.zoom"),p=v.on("dblclick.zoom");function g(e,t){return v?new Promise(n=>{null==f||f.interpolate((null==t?void 0:t.interpolate)==="linear"?M.Z:b.Z).transform(ta(v,null==t?void 0:t.duration,null==t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)}function E(){f.on("zoom",null)}async function I(e,t,n){let o=ti(e),i=null==f?void 0:f.constrain()(o,t,n);return i&&await g(i),new Promise(e=>e(i))}return f.wheelDelta(td),{update:function(e){let{noWheelClassName:t,noPanClassName:n,onPaneContextMenu:o,userSelectionActive:i,panOnScroll:l,panOnDrag:h,panOnScrollMode:g,panOnScrollSpeed:x,preventScrolling:w,zoomOnPinch:M,zoomOnScroll:b,zoomOnDoubleClick:I,zoomActivationKeyPressed:P,lib:z,onTransformChange:N,connectionInProgress:H,paneClickDistance:A,selectionOnDrag:B}=e;i&&!s.isZoomingOrPanning&&E();let L=l&&!P&&!i;f.clickDistance(B?1/0:!ee(A)||A<0?0:A);let T=L?function(e){let{zoomPanValues:t,noWheelClassName:n,d3Selection:o,d3Zoom:i,panOnScrollMode:l,panOnScrollSpeed:r,zoomOnPinch:u,onPanZoomStart:a,onPanZoom:d,onPanZoomEnd:s}=e;return e=>{if(tl(e,n))return e.ctrlKey&&e.preventDefault(),!1;e.preventDefault(),e.stopImmediatePropagation();let h=o.property("__zoom").k||1;if(e.ctrlKey&&u){let t=(0,m.Z)(e),n=td(e);i.scaleTo(o,h*Math.pow(2,n),t,e);return}let f=1===e.deltaMode?20:1,v=l===c.Vertical?0:e.deltaX*f,y=l===c.Horizontal?0:e.deltaY*f;!eu()&&e.shiftKey&&l!==c.Vertical&&(v=e.deltaY*f,y=0),i.translateBy(o,-(v/h)*r,-(y/h)*r,{internal:!0});let p=to(o.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(null==d||d(e,p),t.panScrollTimeout=setTimeout(()=>{null==s||s(e,p),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,null==a||a(e,p))}}({zoomPanValues:s,noWheelClassName:t,d3Selection:v,d3Zoom:f,panOnScrollMode:g,panOnScrollSpeed:x,zoomOnPinch:M,onPanZoomStart:u,onPanZoom:r,onPanZoomEnd:a}):function(e){let{noWheelClassName:t,preventScrolling:n,d3ZoomHandler:o}=e;return function(e,i){let l="wheel"===e.type,r=!n&&l&&!e.ctrlKey,u=tl(e,t);if(e.ctrlKey&&l&&u&&e.preventDefault(),r||u)return null;e.preventDefault(),o.call(this,e,i)}}({noWheelClassName:t,preventScrolling:w,d3ZoomHandler:y});if(v.on("wheel.zoom",T,{passive:!1}),!i){let e=function(e){let{zoomPanValues:t,onDraggingChange:n,onPanZoomStart:o}=e;return e=>{var i,l,r;if(null===(i=e.sourceEvent)||void 0===i?void 0:i.internal)return;let u=to(e.transform);t.mouseButton=(null===(l=e.sourceEvent)||void 0===l?void 0:l.button)||0,t.isZoomingOrPanning=!0,t.prevViewport=u,(null===(r=e.sourceEvent)||void 0===r?void 0:r.type)==="mousedown"&&n(!0),o&&(null==o||o(e.sourceEvent,u))}}({zoomPanValues:s,onDraggingChange:d,onPanZoomStart:u});f.on("start",e);let t=function(e){let{zoomPanValues:t,panOnDrag:n,onPaneContextMenu:o,onTransformChange:i,onPanZoom:l}=e;return e=>{var r,u,a;t.usedRightMouseButton=!!(o&&tr(n,null!==(a=t.mouseButton)&&void 0!==a?a:0)),(null===(r=e.sourceEvent)||void 0===r?void 0:r.sync)||i([e.transform.x,e.transform.y,e.transform.k]),!l||(null===(u=e.sourceEvent)||void 0===u?void 0:u.internal)||null==l||l(e.sourceEvent,to(e.transform))}}({zoomPanValues:s,panOnDrag:h,onPaneContextMenu:!!o,onPanZoom:r,onTransformChange:N});f.on("zoom",t);let n=function(e){let{zoomPanValues:t,panOnDrag:n,panOnScroll:o,onDraggingChange:i,onPanZoomEnd:l,onPaneContextMenu:r}=e;return e=>{var u,a;if((null===(u=e.sourceEvent)||void 0===u||!u.internal)&&(t.isZoomingOrPanning=!1,r&&tr(n,null!==(a=t.mouseButton)&&void 0!==a?a:0)&&!t.usedRightMouseButton&&e.sourceEvent&&r(e.sourceEvent),t.usedRightMouseButton=!1,i(!1),l)){let n=to(e.transform);t.prevViewport=n,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{null==l||l(e.sourceEvent,n)},o?150:0)}}}({zoomPanValues:s,panOnDrag:h,panOnScroll:l,onPaneContextMenu:o,onPanZoomEnd:a,onDraggingChange:d});f.on("end",n)}let k=function(e){let{zoomActivationKeyPressed:t,zoomOnScroll:n,zoomOnPinch:o,panOnDrag:i,panOnScroll:l,zoomOnDoubleClick:r,userSelectionActive:u,noWheelClassName:a,noPanClassName:d,lib:s,connectionInProgress:c}=e;return e=>{var h;let f=t||n,v=o&&e.ctrlKey,y="wheel"===e.type;if(1===e.button&&"mousedown"===e.type&&(tl(e,"".concat(s,"-flow__node"))||tl(e,"".concat(s,"-flow__edge"))))return!0;if(!i&&!f&&!l&&!r&&!o||u||c&&!y||tl(e,a)&&y||tl(e,d)&&(!y||l&&y&&!t)||!o&&e.ctrlKey&&y)return!1;if(!o&&"touchstart"===e.type&&(null===(h=e.touches)||void 0===h?void 0:h.length)>1)return e.preventDefault(),!1;if(!f&&!l&&!v&&y||!i&&("mousedown"===e.type||"touchstart"===e.type)||Array.isArray(i)&&!i.includes(e.button)&&"mousedown"===e.type)return!1;let p=Array.isArray(i)&&i.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||y)&&p}}({zoomActivationKeyPressed:P,panOnDrag:h,zoomOnScroll:b,panOnScroll:l,zoomOnDoubleClick:I,zoomOnPinch:M,userSelectionActive:i,noPanClassName:n,noWheelClassName:t,lib:z,connectionInProgress:H});f.filter(k),I?v.on("dblclick.zoom",p):v.on("dblclick.zoom",null)},destroy:E,setViewport:async function(e,t){let n=ti(e);return await g(n,t),new Promise(e=>e(n))},setViewportConstrained:I,getViewport:function(){let e=v?(0,w.P2)(v.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}},scaleTo:function(e,t){return v?new Promise(n=>{null==f||f.interpolate((null==t?void 0:t.interpolate)==="linear"?M.Z:b.Z).scaleTo(ta(v,null==t?void 0:t.duration,null==t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)},scaleBy:function(e,t){return v?new Promise(n=>{null==f||f.interpolate((null==t?void 0:t.interpolate)==="linear"?M.Z:b.Z).scaleBy(ta(v,null==t?void 0:t.duration,null==t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)},setScaleExtent:function(e){null==f||f.scaleExtent(e)},setTranslateExtent:function(e){null==f||f.translateExtent(e)},syncViewport:function(e){if(v){let t=ti(e),n=v.property("__zoom");(n.k!==e.zoom||n.x!==e.x||n.y!==e.y)&&(null==f||f.transform(v,t,null,{sync:!0}))}},setClickDistance:function(e){let t=!ee(e)||e<0?0:e;null==f||f.clickDistance(t)}}}(d=p||(p={})).Line="line",d.Handle="handle"}}]);